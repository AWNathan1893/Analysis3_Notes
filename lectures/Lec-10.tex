\documentclass[../Analysis-3.tex]{subfiles}

\begin{document}
\chapter*{Lecture 10} %Set chapter name
\addcontentsline{toc}{chapter}{Lecture 10} %Set chapter title
\setcounter{chapter}{10} %Set chapter counter


\begin{Eg}{Exercise}{}
  Take, \[ f(x,y) = \begin{cases}
      \frac{x^{3}y}{x^2 + y^2} & (x,y) \neq (0,0) \\
      0                        & (x,y) = (0,0)
    \end{cases}\]
  Then,
  \begin{enumerate}[label=(\roman*)]
    \item Prove that, $f$ is continuous at $(0,0)$.
    \item Find $(D_{u}f)(0,0)\ \forall\ u$.
    \item Prove that, $f$ is not differentiable.
  \end{enumerate}
\end{Eg}

\section{Extension of MVT to Several Variables}

\begin{Thm}{}{multi:mvt}
  Let $ \Op{n} \subseteq \R^n $ be open and convex and $f : \Op{n} \to \R$ be a differentiable function. For $a,b \in \Op{n}$ define \[L_{a,b} := \left\{ tb + (1-t)a : t \in [0,1]\right\} \]
  Then, $\exists\, c \in L_{a,b}$ such that, \[ f(b) - f(a) = (\grad f)(c)\cdot (b-a) = \left\langle f_{x_1}(c), \ldots, f_{x_n}(c) \right\rangle \cdot \left\langle (b_1 - a_1), \ldots, (b_n - a_n) \right\rangle  \]
\end{Thm}

\begin{proof}
  We consider $\eta : [0,1] \to \Op{n}$

  \[\begin{tikzcd}
      {[0,1]} &&& {\Op{n}} &&& {\R}
      \arrow["\eta", from=1-1, to=1-4]
      \arrow["f", from=1-4, to=1-7]
      \arrow["{f \circ \eta}"', curve={height=30pt}, from=1-1, to=1-7]
    \end{tikzcd}\]

  defined by $\eta (t) = (1-t)a + tb$. Then, $\eta$ is differentiable and its derivative \[ \eta'(t) = \begin{pmatrix}
      b_1 - a_1 \\
      \vdots    \\
      b_n -a_n
    \end{pmatrix} \]

  So, by standard MVT, $\exists\ t_{0} \in (0,1)$ such that,
  \begin{align*}
             & (f \circ \eta)(1) - (f \circ \eta)(0) = (f \circ \eta)'(t_0)                                                                                        \\
    \implies & f(\eta(1)) - f(\eta(0)) = Df(\eta(t_0)). D\eta(t_0)                                                                                                 \\
    \implies & f(b) - f(a) = \begin{pmatrix}
                               f_{x_1}(\eta(t_0)) & f_{x_2}(\eta(t_0)) & \cdots & f_{x_n}(\eta(t_0))
                             \end{pmatrix} \begin{pmatrix}
                                             b_1 - a_1 \\
                                             b_2 -a_2  \\
                                             \vdots    \\
                                             b_n -a_n
                                           \end{pmatrix}                                                                 \\
    \implies & f(b) - f(a) = \left\langle f_{x_1}(\eta(t_0)),  \cdots,f_{x_n}(\eta(t_0)) \right\rangle.\left\langle (b_1 - a_1), \cdots, (b_n - a_n) \right\rangle \\
    \implies & f(b) - f(a) = (\grad f)(\eta(t_0))\cdot(b-a)
  \end{align*}

  Hence, we get $c = \eta(t_0) \in L_{a,b}$ such that \[ f(b) - f(a) = (\grad f)(c)\cdot(b-a) \]
\end{proof}

\section{More Partials and Chain Rules}

We consider $ f $ and $ g $ as following,
\[\begin{tikzcd}
    {\Op{n}} && {\Op{m}} && {\R^p}
    \arrow["f", from=1-1, to=1-3]
    \arrow["g", from=1-3, to=1-5]
  \end{tikzcd}\]
and we assume that $f$ is differentiable at $a \in \Op{n}$ and $g$ is differentiable at $b = f(a) \in \Op{m}$. Considering, $g \circ f = \left( (g \circ f)_1, (g \circ f)_2, \ldots, (g \circ f)_p \right)$, $g = \left( g_1, g_2, \ldots, g_p \right)$ and $f = \left( f_1, f_2, \ldots, f_m \right)$ chain rule gives,

\begin{align*}
  \underbrace{D(g \circ f)(a)}_{\R^n \to \R^p}
   & = (Dg)(f(a))\cdot (Df)(a)                                                     \\
   & = \underbrace{Dg(b)}_{\R^m \to \R^p} \cdot \underbrace{Df(a)}_{\R^n \to \R^m}
\end{align*}
i.e.,
\[ {J_{g \circ f}(a)}_{p \times n} = {J_{g}(f(a))}_{p \times m}\cdot {J_{f}(a)}_{m \times n} \]

Taking $(i,j)^{\text{th}}$ entry of both sides, we get,
\[  \pdv{(g\circ f)_{i}}{x_j}\left( a \right) = \begin{pmatrix}
    \pdv{g_i}{y_1}\left( f(a) \right) & \pdv{g_i}{y_2}\left( f(a) \right) & \cdots & \pdv{g_i}{y_m}\left( f(a) \right)
  \end{pmatrix} \begin{pmatrix}
    \pdv{f_1}{x_j}\left( a \right) \\
    \pdv{f_2}{x_j}\left( a \right) \\
    \vdots                         \\
    \pdv{f_m}{x_j}\left( a \right)
  \end{pmatrix} \]
i.e.,
\[  \pdv{(g\circ f)_{i}}{x_j}\left( a \right) = \sum_{k = 1}^{m} \pdv{g_i}{y_k}\left( f(a) \right)\cdot\pdv{f_k}{x_j}\left( a \right)  \]

So, we have the chain rule for partial derivative of differentiable functions as,
\[  \boxed{
    \pdv{\left( g\circ f \right)_i}{x_j}\left( a \right) = \sum_{k = 1}^{m} \pdv{g_i}{y_k}\left( b \right)\cdot\pdv{f_k}{x_j}\left( a \right)
  } \]
where, $b = f(a)$. Taking $y_k = f_k \left( x_1, x_2, \ldots, x_n \right)$ and $z_i = g_i \left( y_1, y_2, \ldots, y_m \right)$ we may write,
\[  \boxed{
    \pdv{z_i}{x_j}\left( x \right) = \sum_{k=1}^{m} \pdv{z_i}{y_k}\left( y \right) \cdot \pdv{y_k}{x_j}\left( x \right)
  } \]

% Missing explanation

\textbf{Remark.}  For a composition map below, along with differentiability assumption,

\[\begin{tikzcd}
    {\Op{1}} && {\Op{n}} && \R \\
    t && {\left( x_1(t), \ldots,x_n(t) \right)} && {f\left( x_1(t), \ldots,x_n(t) \right)}
    \arrow["\eta", from=1-1, to=1-3]
    \arrow["f", from=1-3, to=1-5]
    \arrow["\eta", maps to, from=2-1, to=2-3]
    \arrow["f", maps to, from=2-3, to=2-5]
    \arrow["{z = f\circ \eta}"', curve={height=30pt}, maps to, from=2-1, to=2-5]
  \end{tikzcd}\]

the chain rule is,

\[\boxed{
    \dv{z}{t} = \sum_{k=1}^{n} \pdv{f}{x_k} \cdot \dv{x_k}{t}
  }\]

Treating $ f $ as a function of $ t $, we may also write,

\[\boxed{
    \dv{f}{t} = \sum_{k=1}^{n} \pdv{f}{x_k} \cdot \dv{x_k}{t}
  }\]

\end{document}